let mobMenu=document.querySelector(".header-mobile-menu");function openModal(e){let t=document.querySelector(".modal.open");t||mobMenu.classList.contains("menu--active")||disableScroll(),t&&t.classList.remove("open"),e.classList.add("open")}function closeModal(e){e.classList.remove("open"),setTimeout((()=>{mobMenu.classList.contains("menu--active")||enableScroll()}),400)}const stories=document.querySelector(".stories"),story=document.querySelectorAll(".item-story");if(stories&&story.length>0){if(stories.querySelector(".swiper")){new Swiper(stories.querySelector(".swiper"),{slidesPerView:2,spaceBetween:10,observer:!0,observeparents:!0,watchSlidesProgress:!0,breakpoints:{1250:{slidesPerView:5,spaceBetween:20},960:{slidesPerView:4,spaceBetween:20},639:{slidesPerView:3,spaceBetween:20}},speed:800})}story.forEach((e=>{let t=e.querySelectorAll(".item-story__story").length;if(+e.getAttribute("data-watched")==t?(e.classList.add("seen"),e.setAttribute("data-last",0)):e.setAttribute("data-last",+e.getAttribute("data-watched")),t>1){let r=(e.querySelector(".item-story__bg-path").getTotalLength()-20*t)/t;e.querySelector(".item-story__bg-path").style.strokeDasharray=`${r} 20`}})),stories.addEventListener("click",(e=>{story.forEach(((t,r)=>{if(t.contains(e.target)){let l=r;document.querySelector(".footer").insertAdjacentHTML("afterend",`\n                <div class="modal story-modal">\n                     <button class="btn-reset modal__close">\n                         <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" viewBox="0 0 42 42" fill="none">\n                             <line x1="10.3935" y1="31.2531" x2="31.2531" y2="10.3935" stroke-width="1.5"></line>\n                             <line x1="31.2529" y1="31.6065" x2="10.3932" y2="10.7469" stroke-width="1.5"></line>\n                         </svg>\n                     </button>\n                    <div class="modal__overlay">\n                        <div class="modal__content">\n                            <div class="modal__inner">\n                                <div class="swiper">\n                                    <div class="swiper-wrapper">\n                                        ${Array.from(story).map((e=>`<div class="swiper-slide">\n                                            <div class="story-modal__item">\n                                                <div class="story-modal__progress">\n                                                    ${Array.from(e.querySelectorAll(".item-story__story")).map((e=>'<div class="story-modal__progress-bar">\n                                                        <span></span>\n                                                    </div>')).join("")}\n                                                </div>\n                                                <div class="media-cover"></div>\n                                                <div class="story-modal__content"></div>\n                                                <form class="form story-form">\n                                                    <textarea placeholder="Сообщение..." name="message"></textarea>\n                                                    <button type="submit" class="btn-reset story-form__btn">\n                                                        <svg xmlns="http://www.w3.org/2000/svg" id="send" viewBox="0 0 18 18">\n                                                        <path d="M12.1048 2.2193L5.33234 4.4693C0.779844 5.9918 0.779844 8.4743 5.33234 9.9893L7.34234 10.6568L8.00984 12.6668C9.52484 17.2193 12.0148 17.2193 13.5298 12.6668L15.7873 5.9018C16.7923 2.8643 15.1423 1.2068 12.1048 2.2193ZM12.3448 6.2543L9.49484 9.1193C9.38234 9.2318 9.23984 9.2843 9.09734 9.2843C8.95484 9.2843 8.81234 9.2318 8.69984 9.1193C8.48234 8.9018 8.48234 8.5418 8.69984 8.3243L11.5498 5.4593C11.7673 5.2418 12.1273 5.2418 12.3448 5.4593C12.5623 5.6768 12.5623 6.0368 12.3448 6.2543Z"/>\n                                                        </svg>\n                                                    </button>\n                                                </form>\n                                            </div>\n                                        </div>`)).join("")}\n                                    </div>\n                                    <button type="button" class="btn-reset nav-btn nav-btn--prev">\n                                        <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60" fill="none">\n                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M29.73 -0.00260162L0.216305 29.5111L29.73 59.0248L33.2952 55.4596L9.86778 32.0321H60V26.9901H9.86778L33.2952 3.56264L29.73 -0.00260162Z" fill="white"/>\n                                        </svg>\n                                    </button>\n                                    <button type="button" class="btn-reset nav-btn nav-btn--next">\n                                        <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60" fill="none">\n                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M30.27 -0.00260162L59.7837 29.5111L30.27 59.0248L26.7048 55.4596L50.1322 32.0321H0V26.9901H50.1322L26.7048 3.56264L30.27 -0.00260162Z" fill="white"/>\n                                        </svg>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                `);const a=document.querySelector(".story-modal");let n,i,d,c=+t.getAttribute("data-last"),y=new Swiper(".story-modal .swiper",{slidesPerView:1,observer:!0,observeParents:!0,initialSlide:l,navigation:{prevEl:".story-modal .nav-btn--prev",nextEl:".story-modal .nav-btn--next"},on:{navigationPrev:()=>{l--,clearTimeout(i),d.querySelectorAll(".story-modal__progress-bar span")[c].style.transitionDuration="0s",d.querySelectorAll(".story-modal__progress-bar")[c].classList.remove("seen"),c=+story[l].getAttribute("data-last"),s()},navigationNext:()=>{l++,clearTimeout(i),d.querySelectorAll(".story-modal__progress-bar span")[c].style.transitionDuration="0s",d.querySelectorAll(".story-modal__progress-bar")[c].classList.remove("seen"),c=+story[l].getAttribute("data-last"),s()}},speed:500});function s(){n=story[l].querySelectorAll(".item-story__story").length,d=a.querySelectorAll(".swiper-slide")[l];let e=story[l].querySelectorAll(".item-story__story")[c].cloneNode(!0),t=story[l].querySelectorAll(".item-story__mod-item")[c].querySelector(".item-story__mod-content");function r(e){e.querySelector("textarea").value.length>0?e.classList.add("btn-show"):e.classList.remove("btn-show")}d.querySelector(".story-modal__content").innerHTML=t?t.innerHTML:"",d.querySelector(".media-cover").innerHTML=story[l].querySelectorAll(".item-story__mod-item")[c].querySelector(".item-story__mod-src").innerHTML,d.querySelectorAll(".story-modal__progress-bar").forEach(((e,t)=>{t<c&&(e.querySelector("span").style.transitionDuration="0s",e.classList.add("seen"))})),d.querySelectorAll("[data-src]").forEach((e=>{e.setAttribute("src",e.getAttribute("data-src")),e.removeAttribute("data-src")})),d.querySelector("[data-srcset]")&&d.querySelectorAll("[data-srcset]").forEach((e=>{e.setAttribute("srcset",e.getAttribute("data-srcset")),e.removeAttribute("data-srcset")})),"video"==e.tagName.toLowerCase()?d.querySelector(".media-cover video").addEventListener("loadedmetadata",(e=>{let t=d.querySelector(".media-cover video").duration;d.querySelectorAll(".story-modal__progress-bar span")[c].style.transitionDuration=t+"s",d.querySelector(".media-cover video").play(),d.querySelector(".media-cover video").setAttribute("autoplay",""),d.querySelectorAll(".story-modal__progress-bar")[c].classList.add("seen"),i=setTimeout(o,100*t)})):(d.querySelectorAll(".story-modal__progress-bar span")[c].style.transitionDuration="1.5s",d.querySelectorAll(".story-modal__progress-bar")[c].classList.add("seen"),i=setTimeout(o,1500));let s=d.querySelector(".story-form");r(s),s.querySelector("textarea").addEventListener("input",(()=>{let e=s.querySelector("textarea");e.style.height="",e.style.height=e.style.height=e.scrollHeight+"px",r(s)})),s.addEventListener("submit",(e=>{e.preventDefault(),s.querySelector("textarea").value="",s.querySelector("textarea").style.height="",r(s)}))}function o(){c<n-1?(c++,story[l].setAttribute("data-last",c),story[l].setAttribute("data-watched",c),s()):(story[l].setAttribute("data-watched",c+1),story[l].setAttribute("data-last",0),story[l].classList.add("seen"),d.querySelectorAll(".story-modal__progress-bar").forEach((e=>{e.querySelector("span").style.transitionDuration="0",e.classList.remove("seen")})),l<story.length-1?(l++,y.slideTo(l),c=+story[l].getAttribute("data-last"),s()):closeModal(a)),story[l].setAttribute("data-watched",c+1)}openModal(a),s(),a.querySelector(".modal__close").addEventListener("click",(e=>{clearTimeout(i),closeModal(a),setTimeout((()=>{a.remove()}),400)}))}}))}))}